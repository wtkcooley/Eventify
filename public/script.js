const brandonTopTracks = {
    "items" : [ {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/3BxsweDMcgp9gNWmG40u6f"
          },
          "href" : "https://api.spotify.com/v1/artists/3BxsweDMcgp9gNWmG40u6f",
          "id" : "3BxsweDMcgp9gNWmG40u6f",
          "name" : "Huddy",
          "type" : "artist",
          "uri" : "spotify:artist:3BxsweDMcgp9gNWmG40u6f"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/6J3MyFpk3rKOlthkLrW7q9"
        },
        "href" : "https://api.spotify.com/v1/albums/6J3MyFpk3rKOlthkLrW7q9",
        "id" : "6J3MyFpk3rKOlthkLrW7q9",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b273892e8005b7fc8f16d11241e9",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e02892e8005b7fc8f16d11241e9",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d00004851892e8005b7fc8f16d11241e9",
          "width" : 64
        } ],
        "name" : "Teenage Heartbreak",
        "release_date" : "2021-09-17",
        "release_date_precision" : "day",
        "total_tracks" : 11,
        "type" : "album",
        "uri" : "spotify:album:6J3MyFpk3rKOlthkLrW7q9"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/3BxsweDMcgp9gNWmG40u6f"
        },
        "href" : "https://api.spotify.com/v1/artists/3BxsweDMcgp9gNWmG40u6f",
        "id" : "3BxsweDMcgp9gNWmG40u6f",
        "name" : "Huddy",
        "type" : "artist",
        "uri" : "spotify:artist:3BxsweDMcgp9gNWmG40u6f"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 183361,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USUM72101562"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/0FPfkAGl5xLLZ8kIl7eDYi"
      },
      "href" : "https://api.spotify.com/v1/tracks/0FPfkAGl5xLLZ8kIl7eDYi",
      "id" : "0FPfkAGl5xLLZ8kIl7eDYi",
      "is_local" : false,
      "name" : "The Eulogy of You and Me",
      "popularity" : 47,
      "preview_url" : "https://p.scdn.co/mp3-preview/616340ae8bcd6ae48f4d0922e1b794b3e86e41c7?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 9,
      "type" : "track",
      "uri" : "spotify:track:0FPfkAGl5xLLZ8kIl7eDYi"
    }, {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
          },
          "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
          "id" : "4jsiUTsxOLc2uaHpyOsNwO",
          "name" : "40s Party Music",
          "type" : "artist",
          "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/6e0QL3BmvbASWDFC3VpM86"
        },
        "href" : "https://api.spotify.com/v1/albums/6e0QL3BmvbASWDFC3VpM86",
        "id" : "6e0QL3BmvbASWDFC3VpM86",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b273515bc32f3987c2f3e395e93e",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e02515bc32f3987c2f3e395e93e",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d00004851515bc32f3987c2f3e395e93e",
          "width" : 64
        } ],
        "name" : "In The Mood - 40s Party Music",
        "release_date" : "2011-01-04",
        "release_date_precision" : "day",
        "total_tracks" : 12,
        "type" : "album",
        "uri" : "spotify:album:6e0QL3BmvbASWDFC3VpM86"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
        },
        "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
        "id" : "4jsiUTsxOLc2uaHpyOsNwO",
        "name" : "40s Party Music",
        "type" : "artist",
        "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 208200,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USA371145870"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/0ZE27gUSdJTXISmeVlUhal"
      },
      "href" : "https://api.spotify.com/v1/tracks/0ZE27gUSdJTXISmeVlUhal",
      "id" : "0ZE27gUSdJTXISmeVlUhal",
      "is_local" : false,
      "name" : "Them There Eyes",
      "popularity" : 3,
      "preview_url" : "https://p.scdn.co/mp3-preview/1c49b203a430638148a1986edf47d231ad9787e6?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 6,
      "type" : "track",
      "uri" : "spotify:track:0ZE27gUSdJTXISmeVlUhal"
    }, {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/1pgtr4nhBQjp9oCUBPyYWh"
          },
          "href" : "https://api.spotify.com/v1/artists/1pgtr4nhBQjp9oCUBPyYWh",
          "id" : "1pgtr4nhBQjp9oCUBPyYWh",
          "name" : "Fountains Of Wayne",
          "type" : "artist",
          "uri" : "spotify:artist:1pgtr4nhBQjp9oCUBPyYWh"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/6TZp52tXShLQbq8yNMxqNT"
        },
        "href" : "https://api.spotify.com/v1/albums/6TZp52tXShLQbq8yNMxqNT",
        "id" : "6TZp52tXShLQbq8yNMxqNT",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b273079e826265dffc3a8a26bac5",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e02079e826265dffc3a8a26bac5",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d00004851079e826265dffc3a8a26bac5",
          "width" : 64
        } ],
        "name" : "Welcome Interstate Managers",
        "release_date" : "2003-01-01",
        "release_date_precision" : "day",
        "total_tracks" : 17,
        "type" : "album",
        "uri" : "spotify:album:6TZp52tXShLQbq8yNMxqNT"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/1pgtr4nhBQjp9oCUBPyYWh"
        },
        "href" : "https://api.spotify.com/v1/artists/1pgtr4nhBQjp9oCUBPyYWh",
        "id" : "1pgtr4nhBQjp9oCUBPyYWh",
        "name" : "Fountains Of Wayne",
        "type" : "artist",
        "uri" : "spotify:artist:1pgtr4nhBQjp9oCUBPyYWh"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 197986,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USESC0300016"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/27L8sESb3KR79asDUBu8nW"
      },
      "href" : "https://api.spotify.com/v1/tracks/27L8sESb3KR79asDUBu8nW",
      "id" : "27L8sESb3KR79asDUBu8nW",
      "is_local" : false,
      "name" : "Stacy's Mom",
      "popularity" : 71,
      "preview_url" : "https://p.scdn.co/mp3-preview/b8c71d8792ad0af679890ff344f4b463b6a7c9f6?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 3,
      "type" : "track",
      "uri" : "spotify:track:27L8sESb3KR79asDUBu8nW"
    }, {
        "album" : {
          "album_type" : "ALBUM",
          "artists" : [ {
            "external_urls" : {
              "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
            },
            "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
            "id" : "4jsiUTsxOLc2uaHpyOsNwO",
            "name" : "40s Party Music",
            "type" : "artist",
            "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
          } ],
          "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
          "external_urls" : {
            "spotify" : "https://open.spotify.com/album/6e0QL3BmvbASWDFC3VpM86"
          },
          "href" : "https://api.spotify.com/v1/albums/6e0QL3BmvbASWDFC3VpM86",
          "id" : "6e0QL3BmvbASWDFC3VpM86",
          "images" : [ {
            "height" : 640,
            "url" : "https://i.scdn.co/image/ab67616d0000b273515bc32f3987c2f3e395e93e",
            "width" : 640
          }, {
            "height" : 300,
            "url" : "https://i.scdn.co/image/ab67616d00001e02515bc32f3987c2f3e395e93e",
            "width" : 300
          }, {
            "height" : 64,
            "url" : "https://i.scdn.co/image/ab67616d00004851515bc32f3987c2f3e395e93e",
            "width" : 64
          } ],
          "name" : "In The Mood - 40s Party Music",
          "release_date" : "2011-01-04",
          "release_date_precision" : "day",
          "total_tracks" : 12,
          "type" : "album",
          "uri" : "spotify:album:6e0QL3BmvbASWDFC3VpM86"
        },
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
          },
          "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
          "id" : "4jsiUTsxOLc2uaHpyOsNwO",
          "name" : "40s Party Music",
          "type" : "artist",
          "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "disc_number" : 1,
        "duration_ms" : 208200,
        "explicit" : false,
        "external_ids" : {
          "isrc" : "USA371145870"
        },
        "external_urls" : {
          "spotify" : "https://open.spotify.com/track/0ZE27gUSdJTXISmeVlUhal"
        },
        "href" : "https://api.spotify.com/v1/tracks/0ZE27gUSdJTXISmeVlUhal",
        "id" : "0ZE27gUSdJTXISmeVlUhal",
        "is_local" : false,
        "name" : "Them There Eyes",
        "popularity" : 3,
        "preview_url" : "https://p.scdn.co/mp3-preview/1c49b203a430638148a1986edf47d231ad9787e6?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
        "track_number" : 6,
        "type" : "track",
        "uri" : "spotify:track:0ZE27gUSdJTXISmeVlUhal"
      },
      {
        "album" : {
          "album_type" : "ALBUM",
          "artists" : [ {
            "external_urls" : {
              "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
            },
            "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
            "id" : "4jsiUTsxOLc2uaHpyOsNwO",
            "name" : "40s Party Music",
            "type" : "artist",
            "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
          } ],
          "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
          "external_urls" : {
            "spotify" : "https://open.spotify.com/album/6e0QL3BmvbASWDFC3VpM86"
          },
          "href" : "https://api.spotify.com/v1/albums/6e0QL3BmvbASWDFC3VpM86",
          "id" : "6e0QL3BmvbASWDFC3VpM86",
          "images" : [ {
            "height" : 640,
            "url" : "https://i.scdn.co/image/ab67616d0000b273515bc32f3987c2f3e395e93e",
            "width" : 640
          }, {
            "height" : 300,
            "url" : "https://i.scdn.co/image/ab67616d00001e02515bc32f3987c2f3e395e93e",
            "width" : 300
          }, {
            "height" : 64,
            "url" : "https://i.scdn.co/image/ab67616d00004851515bc32f3987c2f3e395e93e",
            "width" : 64
          } ],
          "name" : "In The Mood - 40s Party Music",
          "release_date" : "2011-01-04",
          "release_date_precision" : "day",
          "total_tracks" : 12,
          "type" : "album",
          "uri" : "spotify:album:6e0QL3BmvbASWDFC3VpM86"
        },
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/4jsiUTsxOLc2uaHpyOsNwO"
          },
          "href" : "https://api.spotify.com/v1/artists/4jsiUTsxOLc2uaHpyOsNwO",
          "id" : "4jsiUTsxOLc2uaHpyOsNwO",
          "name" : "40s Party Music",
          "type" : "artist",
          "uri" : "spotify:artist:4jsiUTsxOLc2uaHpyOsNwO"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "disc_number" : 1,
        "duration_ms" : 208200,
        "explicit" : false,
        "external_ids" : {
          "isrc" : "USA371145870"
        },
        "external_urls" : {
          "spotify" : "https://open.spotify.com/track/0ZE27gUSdJTXISmeVlUhal"
        },
        "href" : "https://api.spotify.com/v1/tracks/0ZE27gUSdJTXISmeVlUhal",
        "id" : "0ZE27gUSdJTXISmeVlUhal",
        "is_local" : false,
        "name" : "Them There Eyes",
        "popularity" : 3,
        "preview_url" : "https://p.scdn.co/mp3-preview/1c49b203a430638148a1986edf47d231ad9787e6?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
        "track_number" : 6,
        "type" : "track",
        "uri" : "spotify:track:0ZE27gUSdJTXISmeVlUhal"
      },
    {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/7oPftvlwr6VrsViSDV7fJY"
          },
          "href" : "https://api.spotify.com/v1/artists/7oPftvlwr6VrsViSDV7fJY",
          "id" : "7oPftvlwr6VrsViSDV7fJY",
          "name" : "Green Day",
          "type" : "artist",
          "uri" : "spotify:artist:7oPftvlwr6VrsViSDV7fJY"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/4uG8q3GPuWHQlRbswMIRS6"
        },
        "href" : "https://api.spotify.com/v1/albums/4uG8q3GPuWHQlRbswMIRS6",
        "id" : "4uG8q3GPuWHQlRbswMIRS6",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b273db89b08034de626ebee6823d",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e02db89b08034de626ebee6823d",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d00004851db89b08034de626ebee6823d",
          "width" : 64
        } ],
        "name" : "Dookie",
        "release_date" : "1994-02-01",
        "release_date_precision" : "day",
        "total_tracks" : 15,
        "type" : "album",
        "uri" : "spotify:album:4uG8q3GPuWHQlRbswMIRS6"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/7oPftvlwr6VrsViSDV7fJY"
        },
        "href" : "https://api.spotify.com/v1/artists/7oPftvlwr6VrsViSDV7fJY",
        "id" : "7oPftvlwr6VrsViSDV7fJY",
        "name" : "Green Day",
        "type" : "artist",
        "uri" : "spotify:artist:7oPftvlwr6VrsViSDV7fJY"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 181533,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USRE19900151"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/6L89mwZXSOwYl76YXfX13s"
      },
      "href" : "https://api.spotify.com/v1/tracks/6L89mwZXSOwYl76YXfX13s",
      "id" : "6L89mwZXSOwYl76YXfX13s",
      "is_local" : false,
      "name" : "Basket Case",
      "popularity" : 77,
      "preview_url" : "https://p.scdn.co/mp3-preview/376dab935db96e1893f5fb14059147f9399844c5?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 7,
      "type" : "track",
      "uri" : "spotify:track:6L89mwZXSOwYl76YXfX13s"
    }, {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/5ND0mGcL9SKSjWIjPd0xIb"
          },
          "href" : "https://api.spotify.com/v1/artists/5ND0mGcL9SKSjWIjPd0xIb",
          "id" : "5ND0mGcL9SKSjWIjPd0xIb",
          "name" : "Bowling For Soup",
          "type" : "artist",
          "uri" : "spotify:artist:5ND0mGcL9SKSjWIjPd0xIb"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/2safYwJ4j0WKLcQUwEBQEi"
        },
        "href" : "https://api.spotify.com/v1/albums/2safYwJ4j0WKLcQUwEBQEi",
        "id" : "2safYwJ4j0WKLcQUwEBQEi",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b27397ed7b212715424daac8c600",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e0297ed7b212715424daac8c600",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d0000485197ed7b212715424daac8c600",
          "width" : 64
        } ],
        "name" : "Drunk Enough To Dance",
        "release_date" : "2002",
        "release_date_precision" : "year",
        "total_tracks" : 19,
        "type" : "album",
        "uri" : "spotify:album:2safYwJ4j0WKLcQUwEBQEi"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/5ND0mGcL9SKSjWIjPd0xIb"
        },
        "href" : "https://api.spotify.com/v1/artists/5ND0mGcL9SKSjWIjPd0xIb",
        "id" : "5ND0mGcL9SKSjWIjPd0xIb",
        "name" : "Bowling For Soup",
        "type" : "artist",
        "uri" : "spotify:artist:5ND0mGcL9SKSjWIjPd0xIb"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 197800,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USJI10200080"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/0KqyBk4aVT88TEqBIC8mAP"
      },
      "href" : "https://api.spotify.com/v1/tracks/0KqyBk4aVT88TEqBIC8mAP",
      "id" : "0KqyBk4aVT88TEqBIC8mAP",
      "is_local" : false,
      "name" : "Girl All the Bad Guys Want",
      "popularity" : 60,
      "preview_url" : "https://p.scdn.co/mp3-preview/5bcc19208807576006348dce8e193cb1ad3b6b60?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 3,
      "type" : "track",
      "uri" : "spotify:track:0KqyBk4aVT88TEqBIC8mAP"
    },
    {
      "album" : {
        "album_type" : "ALBUM",
        "artists" : [ {
          "external_urls" : {
            "spotify" : "https://open.spotify.com/artist/3BxsweDMcgp9gNWmG40u6f"
          },
          "href" : "https://api.spotify.com/v1/artists/3BxsweDMcgp9gNWmG40u6f",
          "id" : "3BxsweDMcgp9gNWmG40u6f",
          "name" : "Huddy",
          "type" : "artist",
          "uri" : "spotify:artist:3BxsweDMcgp9gNWmG40u6f"
        } ],
        "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
        "external_urls" : {
          "spotify" : "https://open.spotify.com/album/6J3MyFpk3rKOlthkLrW7q9"
        },
        "href" : "https://api.spotify.com/v1/albums/6J3MyFpk3rKOlthkLrW7q9",
        "id" : "6J3MyFpk3rKOlthkLrW7q9",
        "images" : [ {
          "height" : 640,
          "url" : "https://i.scdn.co/image/ab67616d0000b273892e8005b7fc8f16d11241e9",
          "width" : 640
        }, {
          "height" : 300,
          "url" : "https://i.scdn.co/image/ab67616d00001e02892e8005b7fc8f16d11241e9",
          "width" : 300
        }, {
          "height" : 64,
          "url" : "https://i.scdn.co/image/ab67616d00004851892e8005b7fc8f16d11241e9",
          "width" : 64
        } ],
        "name" : "Teenage Heartbreak",
        "release_date" : "2021-09-17",
        "release_date_precision" : "day",
        "total_tracks" : 11,
        "type" : "album",
        "uri" : "spotify:album:6J3MyFpk3rKOlthkLrW7q9"
      },
      "artists" : [ {
        "external_urls" : {
          "spotify" : "https://open.spotify.com/artist/3BxsweDMcgp9gNWmG40u6f"
        },
        "href" : "https://api.spotify.com/v1/artists/3BxsweDMcgp9gNWmG40u6f",
        "id" : "3BxsweDMcgp9gNWmG40u6f",
        "name" : "Huddy",
        "type" : "artist",
        "uri" : "spotify:artist:3BxsweDMcgp9gNWmG40u6f"
      } ],
      "available_markets" : [ "AD", "AE", "AR", "AT", "AU", "BE", "BG", "BH", "BO", "BR", "CA", "CH", "CL", "CO", "CR", "CY", "CZ", "DE", "DK", "DO", "DZ", "EC", "EE", "EG", "ES", "FI", "FR", "GB", "GR", "GT", "HK", "HN", "HU", "ID", "IE", "IL", "IN", "IS", "IT", "JO", "JP", "KW", "LB", "LI", "LT", "LU", "LV", "MA", "MC", "MT", "MX", "MY", "NI", "NL", "NO", "NZ", "OM", "PA", "PE", "PH", "PL", "PS", "PT", "PY", "QA", "RO", "SA", "SE", "SG", "SK", "SV", "TH", "TN", "TR", "TW", "US", "UY", "VN", "ZA" ],
      "disc_number" : 1,
      "duration_ms" : 183361,
      "explicit" : false,
      "external_ids" : {
        "isrc" : "USUM72101562"
      },
      "external_urls" : {
        "spotify" : "https://open.spotify.com/track/0FPfkAGl5xLLZ8kIl7eDYi"
      },
      "href" : "https://api.spotify.com/v1/tracks/0FPfkAGl5xLLZ8kIl7eDYi",
      "id" : "0FPfkAGl5xLLZ8kIl7eDYi",
      "is_local" : false,
      "name" : "The Eulogy of You and Me",
      "popularity" : 47,
      "preview_url" : "https://p.scdn.co/mp3-preview/616340ae8bcd6ae48f4d0922e1b794b3e86e41c7?cid=31e9c90c0c7c4c68866a4f8d9d40d6b4",
      "track_number" : 9,
      "type" : "track",
      "uri" : "spotify:track:0FPfkAGl5xLLZ8kIl7eDYi"
    } ],
    "total" : 50,
    "limit" : 5,
    "offset" : 0,
    "href" : "https://api.spotify.com/v1/me/top/tracks?limit=5&offset=0&time_range=short_term",
    "next" : "https://api.spotify.com/v1/me/top/tracks?limit=5&offset=5&time_range=short_term",
    "previous" : null
  };

class Users {
    constructor(name) {
        this.name = name;
        this.access_token = access_token;
        this.refresh_token = refresh_token;
        this.top_tracks = [];
        this.setTopTracks();
    }

    /**
     * Gets users top tracks
     * @param {string} access_token - Users access token
     * @param {string} type - the type of top info ("tracks" | "artists")
     * @param {number} limit - the number objects to be returned (1-50)
     * @param {number} offset - the value to start at (1-50)
     * @param {string} time_range - the range of time to grab top info from ("short_term" | "medium_term" | "long_term")
     * @return {JSON Object} - JSON response Object
     */
    async getTopTracks(access_token, type='tracks', limit=50, offset=0, time_range="short_term") {
        let options = {
            method: 'GET',
            headers: {
            'Content-Type': 'application/json',
            'Authorization': ` Bearer ${access_token}`
            }
        }
        let fetch_top_tracks = await fetch(`https://api.spotify.com/v1/me/top/${type}?limit=${limit}&offset=${offset}&time_range=${time_range}`, options)
        .then(res => res.json())
        return fetch_top_tracks;
    }

    setName(name) {
        this.name = name;
    }

    setAccessToken(token) {
        this.access_token = token;
    }

    setRefreshToken(token) {
        this.refresh_token = token;
    }

    async setTopTracks(type='tracks', limit=50, offset=0, time_range="short_term") {
        await this.getTopTracks(this.access_token, type, limit, offset, time_range).then(response => this.top_tracks = response)
    }
}

let params = getHashParams();

let access_token = params.access_token,
    refresh_token = params.refresh_token,
    error = params.error;
    

/**
 * Gets users top tracks
 * @param {string} access_token - Users access token
 * @param {string} type - the type of top info ("tracks" | "artists")
 * @param {number} limit - the number objects to be returned (1-50)
 * @param {number} offset - the value to start at (1-50)
 * @param {string} time_range - the range of time to grab top info from ("short_term" | "medium_term" | "long_term")
 * @return {JSON Object} - JSON response Object
 */
async function getTopTracks(access_token, type='tracks', limit=50, offset=0, time_range="short_term") {
    let options = {
        method: 'GET',
        headers: {
        'Content-Type': 'application/json',
        'Authorization': ` Bearer ${access_token}`
        }
    }
    let fetchTopTracks = fetch(`https://api.spotify.com/v1/me/top/${type}?limit=${limit}&offset=${offset}&time_range=${time_range}`, options);
    fetchTopTracks.then(res =>
        res.json()).then(d => {
            console.log(d);
            return d;
    })
    return fetchTopTracks;
}

/**
 * Gets users top tracks
 * @param {JSON Object} users_tracks - Users and their list of top songs
 * @param {int} length_ms - max length for the playlist in milliseconds
 * @return {String Array} - Array of song IDs
 */
function createPlaylist(users_tracks, length_ms) {
    let multi = [];
    let single = [];

    //Obj Song: {"ID","rating","count","length_ms"}

    // Iterate through each song for each person
    users_tracks.forEach(user => {
        let index = 0;
        user.items.forEach(song => {

            // Check multi list
            let multi_song = multi.find(s => s.ID === song.id);
            if (multi_song !== undefined)
            {
                multi_song.count++;
            }
            
            // Check single list
            else
            {
                let single_song = single.find(s => s.ID === song.id);
                if (single_song !== undefined)
                {
                    // Move song to multi list
                    single = single.filter(s => s !== single_song);
                    single_song.count++;
                    single_song.rating += index;
                    multi.push(single_song);
                }
                else
                {
                    // Add new song
                    let newSong = { ID: song.id, rating: index, count: 1, length_ms: song.duration_ms };
                    single.push(newSong);
                }
            }

            index++;
        });
    });

    // Create playlist array based on rating and count
    // * The length of the playlist must also be tracked so it does not grow to large
    
    let playlist = [];
    let play_length_ms = 0;
    
    // Implement mutli values for song rankings
    multi_values = multi.map(s => {
        return {
            ID: s.ID,
            value: s.rating / s.count
        };
    });
    
    // Sorts songs for rankings
    multi_values.sort((a, b) => a.value - b.value);
    single.sort((a, b) => a.rating - b.rating);

    // Add songs to playlist

    multi_values.forEach(s => {
        // Return playlist if length becomes to long
        if ((play_length_ms+s.length_ms) > length_ms)
            return playlist;

        playlist.push(s.ID);
        play_length_ms += s.length_ms;
    });

    single.forEach(s => {
        // Return playlist if length becomes to long
        if ((play_length_ms+s.length_ms) > length_ms)
            return playlist;

        playlist.push(s.ID);
        play_length_ms += s.length_ms;
    });

    //If all songs have been added, return playlist
    return playlist;
}

/**
 * Obtains parameters from the hash of the URL
 * @return Object
 */
function getHashParams() {
    let hashParams = {};
    let e, r = /([^&;=]+)=?([^&;]*)/g,
        q = window.location.hash.substring(1);
    while ( e = r.exec(q)) {
        hashParams[e[1]] = decodeURIComponent(e[2]);
    }

    return hashParams;
}

let userProfileSource = document.getElementById('user-profile-template').innerHTML,
    userProfileTemplate = Handlebars.compile(userProfileSource),
    userProfilePlaceholder = document.getElementById('user-profile');

let userProfile = {};
let Owner = new Users("Owner");
let oauthSource = document.getElementById('oauth-template').innerHTML,
    oauthTemplate = Handlebars.compile(oauthSource),
    oauthPlaceholder = document.getElementById('oauth');

if (error) {
    alert('There was an error during the authentication');
} else {
    if (access_token) {
    // render oauth info
    oauthPlaceholder.innerHTML = oauthTemplate({
        access_token: access_token,
        refresh_token: refresh_token
    });

    $.ajax({
        url: 'https://api.spotify.com/v1/me',
        headers: {
            'Authorization': 'Bearer ' + access_token
        },
        success: function(response) {
            userProfilePlaceholder.innerHTML = userProfileTemplate(response);
            userProfile = response;

            $('#login').hide();
            $('#loggedin').show();
            return response
        }
    }).then(profile =>
        Owner = new Users(profile.display_name, access_token, refresh_token));

        console.log(Owner);
    } else {
        // render initial screen
        $('#login').show();
        $('#loggedin').hide();
    }

    document.getElementById('obtain-new-token').addEventListener('click', function() {
    $.ajax({
        url: '/refresh_token',
        data: {
        'refresh_token': refresh_token
        }
    }).done(function(data) {
        access_token = data.access_token;
        oauthPlaceholder.innerHTML = oauthTemplate({
        access_token: access_token,
        refresh_token: refresh_token
        });
    });
    }, false);
}
